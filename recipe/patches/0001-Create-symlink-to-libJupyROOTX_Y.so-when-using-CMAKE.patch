From 0c93d50e8496dc41f020590f050efceeb8528133 Mon Sep 17 00:00:00 2001
From: Chris Burr <christopher.burr@cern.ch>
Date: Sat, 22 Aug 2020 21:08:44 +0200
Subject: [PATCH] Create symlink to libJupyROOTX_Y.so when using
 CMAKE_INSTALL_PYTHONDIR

---
 bindings/jupyroot/CMakeLists.txt | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/bindings/jupyroot/CMakeLists.txt b/bindings/jupyroot/CMakeLists.txt
index f416dc46e9..1490dfafcf 100644
--- a/bindings/jupyroot/CMakeLists.txt
+++ b/bindings/jupyroot/CMakeLists.txt
@@ -75,6 +75,12 @@ foreach(val RANGE ${how_many_pythons})
                              LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR} COMPONENT libraries
                              ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR} COMPONENT libraries)
 
+  if (NOT CMAKE_INSTALL_LIBDIR STREQUAL CMAKE_INSTALL_PYTHONDIR)
+    # add a symlink to ${libname} in CMAKE_INSTALL_PYTHONDIR
+    install(CODE "execute_process(COMMAND ${CMAKE_COMMAND} -E create_symlink\
+            ${CMAKE_INSTALL_FULL_LIBDIR}/lib${libname}.so\
+            ${CMAKE_INSTALL_FULL_PYTHONDIR}/lib${libname}.so)")
+  endif()
 endforeach()
 
 # Install Python sources and bytecode
-- 
2.27.0

